"use strict";(self.webpackChunkfinalfrontend=self.webpackChunkfinalfrontend||[]).push([[224],{5224:(e,a,r)=>{r.r(a),r.d(a,{default:()=>i});var l=r(7565),o=r(5828),s=r(1887),t=r(8039),n=(r(6804),r(7929));const i=()=>{const[e,a]=(0,l.useState)(null),[r,i]=(0,l.useState)(!0),[d,c]=(0,l.useState)(null),[p,u]=(0,l.useState)(null),h=(0,s.Zp)();(0,l.useEffect)((()=>{localStorage.getItem("token")?m():h("/login")}),[h]);const m=async()=>{try{const e=localStorage.getItem("token"),r=await o.A.get("http://localhost:5001/api/users/profile",{headers:{Authorization:`Bearer ${e}`}});r.data&&(a(r.data),localStorage.setItem("user",JSON.stringify(r.data)))}catch(e){console.error("Profile fetch error:",e),t.oR.error("Failed to fetch user data.")}finally{i(!1)}},f=r=>{a({...e,[r.target.name]:r.target.value})};return(0,n.jsx)("div",{className:"profile-container",children:r?(0,n.jsx)("p",{children:"Loading..."}):e?(0,n.jsxs)("div",{className:"profile-card",children:[(0,n.jsx)("h2",{children:"Your Profile"}),(0,n.jsxs)("form",{onSubmit:async a=>{a.preventDefault();const r=localStorage.getItem("token");if(!r)return void t.oR.error("Authentication error. Please log in again.");if(!e.profilePic&&!d)return void t.oR.error("Please upload a profile picture.");const l=new FormData;l.append("name",e.name||""),l.append("phone",e.phone||""),l.append("gender",e.gender||""),l.append("address",e.address||""),l.append("bio",e.bio||""),l.append("dob",e.dob||""),d&&l.append("profilePicture",d);try{const e=await o.A.put("http://localhost:5001/api/users/profile",l,{headers:{Authorization:`Bearer ${r}`,"Content-Type":"multipart/form-data"}});t.oR.success(e.data.message||"Profile updated successfully!"),m()}catch(i){var s,n;console.error("Profile update error:",i),t.oR.error((null===i||void 0===i||null===(s=i.response)||void 0===s||null===(n=s.data)||void 0===n?void 0:n.message)||"An error occurred")}},children:[(0,n.jsxs)("div",{className:"form-group",children:[p?(0,n.jsx)("img",{src:p,alt:"Preview",className:"profile-image"}):e.profilePic?(0,n.jsx)("img",{src:`http://localhost:5001${e.profilePic}`,alt:"Profile",className:"profile-image"}):(0,n.jsx)("p",{children:"No Profile Picture"}),(0,n.jsx)("input",{type:"file",accept:"image/*",onChange:e=>{const a=e.target.files[0];c(a),a&&u(URL.createObjectURL(a))}})]}),(0,n.jsxs)("div",{className:"form-group",children:[(0,n.jsx)("label",{children:"Full Name:"}),(0,n.jsx)("input",{type:"text",name:"name",value:e.name||"",onChange:f})]}),(0,n.jsxs)("div",{className:"form-group",children:[(0,n.jsx)("label",{children:"Email:"}),(0,n.jsx)("input",{type:"email",name:"email",value:e.email||"",disabled:!0})]}),(0,n.jsxs)("div",{className:"form-group",children:[(0,n.jsx)("label",{children:"Phone:"}),(0,n.jsx)("input",{type:"text",name:"phone",value:e.phone||"",onChange:f})]}),(0,n.jsxs)("div",{className:"form-group",children:[(0,n.jsx)("label",{children:"Date of Birth:"}),(0,n.jsx)("input",{type:"date",name:"dob",value:e.dob?e.dob.split("T")[0]:"",onChange:f})]}),(0,n.jsxs)("div",{className:"form-group",children:[(0,n.jsx)("label",{children:"Gender:"}),(0,n.jsxs)("select",{name:"gender",value:e.gender||"",onChange:f,children:[(0,n.jsx)("option",{value:"",children:"Select Gender"}),(0,n.jsx)("option",{value:"male",children:"Male"}),(0,n.jsx)("option",{value:"female",children:"Female"}),(0,n.jsx)("option",{value:"other",children:"Other"})]})]}),(0,n.jsxs)("div",{className:"form-group",children:[(0,n.jsx)("label",{children:"Address:"}),(0,n.jsx)("input",{type:"text",name:"address",value:e.address||"",onChange:f})]}),(0,n.jsxs)("div",{className:"form-group",children:[(0,n.jsx)("label",{children:"Bio:"}),(0,n.jsx)("textarea",{name:"bio",value:e.bio||"",onChange:f})]}),(0,n.jsx)("button",{className:"btn",type:"submit",children:"Update Profile"})]})]}):(0,n.jsx)("p",{children:"Error loading profile. Please try again."})})}},6804:()=>{}}]);
//# sourceMappingURL=224.90a30ac3.chunk.js.map